# 4주차 패킷이 인터넷 내부로 진행한다


네트워크는 크게 네트워크 엣지(Network Edge)와 네트워크 코어(Network Core)로 나뉜다.

### 네트워크 엣지(Network Edge)

- 인터넷의 말단 부분. 사용자가 직접 사용하는 네트워크 영역
- 사용자와 서비스 제공자를 연결하고, 데이터를 패킷으로 나누어 전송하는 기능

**구성 요소**
- **Host:** 인터넷에 연결된 클라이언트 & 서버
- **엑세스 네트워크:** 호스트와 네트워크 코어를 연결하는 중간 단계의 네트워크
    - 유선(랜선) 및 무선(Wi-Fi) 통신 링크
    - 모바일 네트워크, 홈 네트워크, 기관 네트워크

### 네트워크 코어(Network Core)

- 서로 연결된 라우터와 스위치로 구성된 부분
- 다양한 엣지 네트워크를 서로 연결하는 “네트워크의 네트워크”
- 라우팅(패킷이 이동해야 할 경로를 결정)과 포워딩(입력된 패킷을 특정 출력으로 전달)

**구성 요소**
- **라우터**: 패킷을 목적지까지 전달하기 위해 서로 연결된 장치들. 패킷의 헤더 정보를 기반으로 최적의 경로를 결정
- **패킷 스위치**: 데이터 전송을 위한 장치로, 패킷을 받아서 다음 목적지로 전달하는 기능. 패킷 교환 방식 사용


## 엑세스 네트워크

- 사용자와 WAN 또는 코어 네트워크를 연결하는 통로 역할
- 인터넷, 전화, 텔레비전 등 다양한 통신 서비스를 제공하며, 사용자와 서비스 제공자 간의 데이터 전송을 가능하게 한다.

### **1. 유선 엑세스 네트워크**

- **DSL(Digital Subscriber Line)**
    - 기존 전화선을 사용하여 고속 인터넷 서비스를 제공하며, 주로 가정에서 사용
    - 업로드와 다운로드 속도가 다르게 설계된 비대칭형 구조
- **케이블**
    - 동축 케이블을 사용하여 텔레비전 및 인터넷 서비스를 제공
    - 주파수 분할 다중화(FDM)를 통해 여러 신호를 동시에 전송하며, 공유형 액세스 지원
- **광섬유**
    - 유리 또는 플라스틱 섬유를 통해 데이터 전송
    - 높은 대역폭과 낮은 지연 시간
    - 장거리 데이터 전송에 적합하고 신호 간섭에 강함

### **2. 무선 엑세스 네트워크**

- **Wi-Fi**
    - 근거리 무선 통신 기술로, 가정, 사무실 및 공공 장소에서 널리 사용됨
    - 비교적 높은 속도를 지원하며 설치 간편
- **셀룰러**
    - 기지국을 통해 데이터를 전송
    - 4G 및 5G 기술을 활용해 광범위한 지역에서 모바일 인터넷 접속을 제공
- **위성**
    - 지구 궤도를 도는 위성을 이용해 데이터를 전송
    - 넓은 지역을 커버하지만 비용이 높고 지연 시간이 클 수 있다.

---

### ADSL 기술을 이용한 액세스 회선의 구조와 동작

사용자측의 라우터에서 송신된 패킷은 ADSL 모뎀이나 전화의 케이블을 통해 전화국에 도착하며, 여기에서 ADSL 사업자의 네트워크를 경유하여 프로바이더(ISP, Internet Service Provider)에 도착한다.

```markdown
[사용자 라우터] → [ADSL 모뎀] → [스플리터] → [전화선] → [DSLAM] → [BAS] → [ISP 라우터]
```

1. **사용자 라우터에서 패킷 생성**
    - 사용자가 웹 페이지 요청, 이메일 송신 등 데이터를 생성하면, 라우터는 이를 IP 패킷으로 변환한다.
    - IP 패킷은 PPPoE 또는 DHCP를 통해 캡슐화되어 ADSL 모뎀으로 전달된다.
2. **ADSL 모뎀에서 신호 변환**
    - ADSL 모뎀은 IP 패킷을 ATM 셀로 분할하고, 이를 전기 신호로 변환환다.
        - ATM 셀은 53바이트(5바이트 헤더 + 48바이트 데이터)로 구성된다.
    - 변환된 전기 신호는 스플리터로 전달된다.
3. **스플리터에서 신호 분리**
    - 스플리터는 전화선으로 들어오는 신호를 두 가지로 나눈다.
        - 음성 신호(POTS): 낮은 주파수(0~4 kHz)를 전화기로 전달
        - ADSL 데이터 신호: 높은 주파수(26~1104 kHz)를 ADSL 모뎀으로 전달
    - 스플리터는 전화기의 음성 신호와 ADSL 데이터 신호가 서로 간섭하지 않도록 한다.
4. **전화선 통과**
    - ADSL 데이터 신호는 기존 구리 전화선을 통해 지역 전화국의 DSLAM으로 전달된다.
    - 이 과정에서 주파수 분할(FDM)을 통해 음성과 데이터가 동시에 전송된다.
5. **DSLAM에서 신호 처리**
    - DSLAM(DSL Access Multiplexer)은 사용자로부터 수신한 전기 신호를 디지털 데이터로 복원한다.
    - 여러 사용자의 데이터를 집계하여 ISP 네트워크로 전달한다.
6. **BAS에서 인증 및 라우팅**
    - BAS(Broadband Access Server)는 PPPoE 헤더를 제거하고 사용자 인증을 수행한다.(CHAP 또는 PAP 방식)
    - BAS는 IP 주소를 할당하고 데이터를 ISP 백본 네트워크로 라우팅한다.
7. **ISP 네트워크 및 인터넷 연결**
    - ISP의 백본 네트워크는 데이터를 최종 목적지(웹 서버 등)로 전달하며, 응답 데이터를 역순으로 사용자에게 반환한다.

### ADSL 특징

1. **비대칭 데이터 전송:** 다운로드 속도가 업로드 속도보다 훨씬 빠르다. 대칭형 서비스에는 적합X
2. **기존 전화선 활용:** 별도의 새로운 인프라 구축 없이 기존 구리 전화선을 그대로 사용한다.
3. **주파수 분리:** 낮은 주파수(0~4 kHz)는 음성 통신에 사용되고, 높은 주파수는 데이터 통신에 사용하여 혼선 없이 두 서비스를 동시에 제공한다.
4. ATM 프로토콜을 사용하여 데이터를 작은 셀 형태로 분할하고 전송한다.
5. 전화국과 사용자 간 거리가 가까울수록 속도가 빠르며, 최대 약 5~6 km까지 안정적인 연결을 제공한다.

---

## 광섬유를 이용한 엑세스 회선

### 광섬유의 기본

- 광섬유는 이중 구조의 가는 섬유질의 투명한 재질로 만들어져 있으며, 안쪽에 있는 코어 부분 속에 광신호를 흘려서 디지털 데이터를 전달한다.
- ADSL은 전기 신호를 사용하여 복잡한 주파수 변조 방식을 활용하지만, 광섬유는 단순히 빛의 점멸(ON/OFF)로 데이터를 표현하기 때문에 더 안정적이고 빠르게 데이터를 전송할 수 있다.

### 싱글모드와 멀티모드

- 싱글모드
    - 코어가 가늘어 빛이 **직진 경로**로만 이동
    - 단일 파장을 사용해 신호 손실이 적고, 고속 장거리 전송에 적합
- 멀티모드
    - 코어가 굵어 빛이 다양한 각도로 반사되며 이동
    - 짧은 거리에서 경제적이지만, 모드 분산으로 인해 대역폭과 거리가 제한됨

### **광신호를 분기시켜서 비용을 절감한다.**

- ADSL 대신 광섬유를 사용하여 사용자측의 인터넷 접속용 라우터와 인터넷 측의 BAS를 접속하는 것이 FTTH(Fiber To The Home) 액세스 회선이다.
- Point-to-Point (P2P) 방식
    - 각 사용자에게 전용 광섬유를 제공하는 방식
    - 전화국에서 사용자까지 1:1로 직접 연결
    - 주로 기업용 고속 회선에 사용
- PON(Passive Optical Network) 방식
    - 광스플리터로 신호를 분기하여 복수 사용자가 하나의 광섬유를 공유하는 방식
    - 분기 지점(전주/배전반)에서 광신호를 나눠 여러 가구에 연결한다.
    - 일반 가정용 FTTH 서비스의 표준 방식

---

## 액세스 회선의 PPP와 터널링

### **BAS(Broadband Access Server)**

BAS는 액세스 네트워크와 ISP의 백본 네트워크 사이를 연결하는 게이트웨이 역할

1. **사용자 인증**
    - PPPoE 또는 PPPoA를 통해 접속한 사용자를 인증 서버(RADIUS, AAA 서버)와 연동하여 확인함.
    - 사용자가 올바른 계정 정보(ID/PW)를 입력하면 BAS가 인증을 수행하고, 승인된 사용자만 인터넷에 접속할 수 있도록 함.
2. **IP 주소 할당**
    - DHCP 또는 RADIUS를 이용하여 사용자의 IP 주소를 할당함.
    - 공인 IP 또는 사설 IP를 부여하여 사용자의 인터넷 연결을 관리.
3. **트래픽 라우팅**
    - 사용자가 인터넷에 접속하면, BAS는 사용자의 패킷을 적절한 인터넷 경로로 라우팅해 줌.
    - ISP 백본 네트워크로 패킷을 전달하고, 반대로 인터넷에서 오는 패킷을 사용자에게 전달하는 역할.

### **PPP와 터널링**

**(1) PPPoE(PPP over Ethernet)**

- **동작 구조**
    1. Discovery 단계
        - 라우터가 이더넷 브로드캐스트로 BAS의 MAC 주소 탐색
        - **`PADI`**(PPPoE Active Discovery Initiation) → **`PADO`**(Offer) → **`PADR`**(Request) → **`PADS`**(Session)
    2. 세션 단계
        - PPP 프레임을 이더넷 패킷에 캡슐화하여 전송한다.
        - **`[MAC 헤더] + [PPPoE 헤더] + [PPP 프레임] + [IP 패킷]`**
- **인증 방식**
    - **PAP**(Password Authentication Protocol): 패스워드를 평문으로 전송 (보안 취약)
    - **CHAP**(Challenge-Handshake Protocol): 해시 함수로 암호화된 인증 (보안 강화)

**(2) PPPoA(PPP over ATM)**

- ADSL 모뎀에서 PPP 프레임을 ATM 셀로 직접 캡슐화한다.
- 이더넷 헤더(MAC/PPPoE) 없이 ATM 헤더만 추가된다.
- **`[ATM 헤더] + [PPP 프레임] + [IP 패킷]`**

**(3) 터널링 동작**

- BAS는 수신한 패킷에서 MAC 헤더와 PPPoE 헤더를 제거한 후, ISP 라우터로 전달하기 위해 터널링 헤더를 추가한다.

### **DHCP 방식**

- PPP 계층을 사용하지 않고, 이더넷 패킷을 ADSL 신호로 직접 변환한다.
- DHCP 서버에서 IP 주소를 자동 할당받는다.

|  | **PPPoE** | **PPPoA** | **DHCP** |
| --- | --- | --- | --- |
| **캡슐화** | 이더넷 + PPP 프레임 | ATM 셀 + PPP 프레임 | 이더넷 직접 전송 |
| **인증** | CHAP/PAP 필수 | CHAP/PAP 필수 | 인증 없음 |
| **헤더** | MAC + PPPoE + PPP | ATM + PPP | MAC + IP |
