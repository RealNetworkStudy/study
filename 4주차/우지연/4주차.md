# 4주차

---

## 공통 흐름 요약 (ADSL/FTTH 공통)

1. **사용자가 단말기(PC, 스마트폰 등)에서 네트워크 요청 발생**
2. **로컬 네트워크(가정 내 공유기)를 통해 액세스 회선으로 이동**
3. **ISP로 트래픽 진입 - PPP 인증 / IP 할당**
4. **프로바이더 네트워크를 통해 인터넷 백본망에 연결**
5. **목적지 서버와 데이터 송수신**

---

### ADSL 기술을 이용한 액세스 회선의 구조와 동작

**■ 이더넷과 인터넷의 패킷 송신 동작의 차이점**

인터넷 접속용 라우터는 액세스 회선의 규칙에 따라 패킷 송신 동작을 실행한다.

- 액세스 회선(통신회선, 접근회선)
    - 일반 가정이라면 ADSL, FTTH, CATV, 전화회선 등
    - 회사의 경우 전용 회선이 추가된다.

(전통적인 전화선 기반으로 지금은 FTTH가 많음)

- **ADSL**: 전화선으로 인터넷을 쓰는 기술 (소리는 아래쪽 주파수, 인터넷은 위쪽 주파수 나눠 씀).

## 1.  ADSL 기술을 이용한 액세스 회선의 구조와 동작

### 핵심 개념:

- **ADSL**: 전화선으로 인터넷을 쓰는 기술 (소리는 아래쪽 주파수, 인터넷은 위쪽 주파수 나눠 씀).
- **비대칭**: 다운로드가 업로드보다 빠름 (예: 24Mbps / 1Mbps).

### 흐름 정리:

1. **사용자 단말기**: PC에서 웹 요청 발생 (예: 구글 접속).
2. 클라이언트 네트워크 내부 전송(LAN)
    - 사용자가 만든 IP패킷은 먼저 리피터 허브나 스위칭 허브를 경유함
    - 이후 공유기(인터넷 접속용 라우터)에 도달
    - 이더넷 구조에서 MAC 주소 기반으로 중계 대상을 판단하여 전달됨
3. **공유기 + ADSL 모뎀**:
- 공유기와 ADSL 모뎀이 **이더넷 방식으로 연결** 되어 있으면,
    
    ➜ 위의 프레임(여러 헤더 포함)을 따라 패킷 송신이 이뤄짐
    
    ➜ **ISP나 액세스 회선 사업자에 따라 헤더 포맷이 달라질 수 있음**
    
    - 공유기는 **NAT**(사설 IP → 공인 IP 변환) 수행.
        
        ```
        공유기:
        NAT(Network Address Translation) 수행
        ➜ 내부 사설 IP를 외부 공인 IP로 변환하여 트래픽 전달 준비
        ```
        
    - 모뎀은 데이터를 **전화선에 맞는 신호로 바꿈**.
        
        ```
        ADSL 모뎀:
        패킷을 수신한 후, ATM 셀 단위로 잘게 분할함
        ➜ ATM 셀 구조: 5바이트 헤더 + 48바이트 데이터
        ➜ 이 데이터 부분에 IP 패킷의 조각을 담아 전송함
        
        전기 신호로 변환하여 전화선으로 송신함
        ➜ 이때 스플리터를 통해 음성 신호와 분리
        ```
        
        ```
        스플리터(Splitter) :
        전화선 하나를 음성 통화용(전화기)과
        인터넷 데이터용(ADSL 모뎀)으로 분리해주는 장치야!
        ```
        
1. **전화선 → 전화국(DSLAM)**:
    - 여러 사람의 데이터를 모아 ISP 내부로 보냄.
    
    ```
    ISP(Internet Service Provider) 
    = 인터넷 서비스 제공자 = 프로바이더(Provider)
    예: KT, SK브로드밴드, LG U+, 등
    ```
    
    ```
    **DSLAM**은 전화국에 있는 장비로, 
    ADSL 신호를 디지털로 바꾸어 통신사 내부망으로 보내주는 "집선기"
    ```
    
2. **ISP 엣지 장비(PPPoE 서버)**:
    - ID/PW로 인증.
    - 공인 IP를 임시로 할당해 줌.
    
    ```
    엣지 장비 = ISP(통신사) 내부에서, 사용자와 가장 가까운 쪽에 위치한 네트워크 장비
    (즉, 사용자에게 “처음으로” 응답해주는 ISP 쪽 장비)
    
    대표적인 엣지 장비 
    * PPPoE 서버 (Point-to-Point Protocol over Ethernet)
    * BRAS (Broadband Remote Access Server)
    * LNS (L2TP Network Server)
    * 인증 서버, DHCP 서버, NAT 장비 등
    ```
    
3. **인터넷 백본망 → 구글 서버 도달**.

---

## 2. 광섬유(FTTH)를 이용한 액세스 회선

### 핵심 개념:

- **FTTH**: 광섬유를 집까지 직접 연결 → 매우 빠르고 안정적.
- **PON**: 통신사에서 광신호를 나눠주는 구조 (Passive Optical Network = 전원 없는 분배기).
- ADSL 신호는 다수의 주파수 신호를 이용해서 복잡하지만, 광신호는 단순(0과1)

### 흐름 정리:

1. **사용자 단말기**: PC, 스마트폰 등에서 요청 발생.
2. **공유기 → ONU**:
    - ONU는 광케이블 신호를 전기 신호로 바꿔주는 장비.
    
    ```
    **ONU (Optical Network Unit)**는 우리 집에 있는 광신호 변환 장치야.
    ```
    
3. **광선로 → 통신사 OLT**:
    - 여러 사용자 데이터를 통신사 망으로 보냄.
    
    ```
    **OLT (Optical Line Terminal)**는 
    통신사 쪽 장비, 여러 집의 ONU에서 올라온 신호를 받는 역할이야.
    
    **통신사 망 vs ISP망
    
    통신사 망**
    - 광선로, OLT, ONU 같은 **전송망(Access Network)**을 
    강조할 때 사용
    
    **ISP 망**
    - 인터넷 접속, IP 할당, DNS 처리 같은 **서비스망(Core Network)**을 
    강조할 때 사용
    ```
    
4. **통신사 내부 VLAN 구성**:
    - 어떤 고객인지 식별하기 위해 태그 붙이기도 함.
5. **IP 할당 / 인증**:
    - 통신사 장비에서 IP 주고 인터넷 연결.

---

## 3. 액세스 회선에서 사용되는 PPP와 터널링

### 핵심 개념:

- **PPP (Point-to-Point Protocol)**: 1:1 연결을 위한 프로토콜 (로그인, IP 받기 등 기능 포함).
- **PPPoE(ISP의 엣지장비중 하나)**: 공유기나 모뎀에서 인터넷 쓸 때 ID/PW 입력하는 방식 (전화선 환경에서 주로 사용).
- **터널링**: 데이터를 감싸서 다른 네트워크를 통해 보내는 기술 (VPN도 이 방식).

### 실무 상황:

- ADSL 쓸 때 PPPoE 접속을 공유기에서 설정 안 하면 인터넷 안 됨.
- PPP 인증 실패 → 통신사 서버에서 차단됨.
- VPN 쓸 때도 터널링 사용 → 내부망 접근 가능.

---

## 4. 액세스 회선 앞에 존재하는 프로바이더 네트워크

### 핵심 개념:

- **프로바이더 네트워크** = ISP(인터넷 통신사) 내부망

```
프로바이더 네트워크 = ISP 내부망 = ISP가 관리하는 전체 네트워크
그 안에는
-> 엣지 장비도 있고
-> 코어망(내부망)도 있다.

[사용자 PC]
   ↓
[ADSL 모뎀 → DSLAM]
   ↓
[엣지 장비 (BAS, PPPoE 서버)]
   ↓ ← 여기까지가 ISP "입구"
[ISP 내부망 / 코어망]
   ↓
[외부 인터넷 or 다른 ISP망]
```

- **엣지 라우터**: 사용자 요청을 처음 받는 장비

```
엣지 라우터(Edge Router)는 사용자의 데이터를 처음으로 받아서
ISP의 코어망(중심 네트워크) 쪽으로 넘겨주는 첫 번째 관문 역할을 한다
```

- **백본망**: 전 세계 인터넷을 연결하는 고속 네트워크

### 흐름 정리:

- 우리가 만든 패킷(= 웹 요청)이 공유기/모뎀을 거쳐 ISP로 도착
- ISP의 **엣지 장비**(예: BAS, PPPoE 서버)가
    - 누가 보냈는지 확인 (**인증**: ID/PW, MAC 주소 등)
    - 이상한 요청인지 확인 (**필터링**: 포트 차단, 트래픽 제어, 방화벽 등)
- 통과되면 ISP 내부망(백본망)으로 전송돼서 인터넷으로 나감

---

## 5. 프로바이더를 경유하여 흐르는 패킷

서버에 웹 요청을 보내고, 서버가 응답을 줄 때까지의 전체 패킷의 왕복 흐름

### Provider = 프로바이더 = ISP

- 일반 사용자에게 **인터넷 회선/접속 서비스** 제공 (ADSL, 광랜 등)
- 기업에게 **전용선, 서버 호스팅, IP 주소, 보안, DNS 등 네트워크 인프라** 제공
- 다른 ISP와 **연결(BGP, IX, 트랜짓)**하여 **글로벌 인터넷 통신망 유지**

### 실제 흐름:

1. 사용자가 PC에서 웹 요청 발생 (DNS → HTTP)
2. 공유기에서 NAT 처리 + PPPoE 인증 (ADSL)
3. 모뎀 → 전화선 → DSLAM
4. DSLAM → ISP 엣지 라우터(BAS/BRAS)
5. 인증 성공 시 공인 IP 할당됨
6. ISP 내부망 → 백본 → 목적지 서버 (예: 구글)
    - 이때 BGP(Border Gateway Protocol)을 통해
        
        
        | 트랜짓(Transit) | 상대에게 인터넷 전체 경로 정보를 통지함 → 
        상대를 통해 모든 목적지에 패킷 전송 가능 |
        | --- | --- |
        | 피어링(Peering) | 서로의 자체 네트워크 정보만 교환 → 
        상대 네트워크 간 통신만 가능, 그 외는 불가 |
        - 다른 프로바이더들과 경로 정보가 교환되어
        - 목적지 서버가 어느쪽에 있는지 판단 가능
    - 경우에 따라 중간에 있는 다른 ISP를 경유하거나
        - IX(Internet Exchange)를 통해 다른 프로바이더로 패킷 전달
7. 목적지 서버(PoP)에 도달 = 웹서버(예: 구글)
    - 서버는 요청에 대한 응답 패킷을 만들어 전송 시작
8. 응답은 반대 방향으로 되돌아옴
```
[PC]
  ↓ 웹 요청 발생 (DNS → HTTP)
[공유기]
  ↓ NAT 처리, PPPoE 인증
[ADSL 모뎀 → 전화선 → DSLAM]
  ↓
[ISP 엣지 라우터]
  ↓ 인증 성공 → 공인 IP 할당
[ISP 내부망 → 백본망 → 목적지 서버 (구글 등)]
  ↓ 응답은 역방향으로 도착
```
